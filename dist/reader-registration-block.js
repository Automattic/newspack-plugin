!function(){"use strict";var e,t,n={};(function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})})(n),e=window.newspackReaderActivation,t=function(){e&&document.querySelectorAll(".newspack-registration").forEach((t=>{const n=t.querySelector("form");if(!n)return;const a=t.querySelector(".newspack-registration__response"),i=n.querySelector('input[type="submit"]');let o=t.querySelector(".newspack-registration__registration-success");n.startLoginFlow=()=>{a.classList.add("newspack-registration--hidden"),a.innerHTML="",i.disabled=!0,t.classList.add("newspack-registration--in-progress")},n.endLoginFlow=function(){let r,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null!=d&&d.existing_user&&(o=t.querySelector(".newspack-registration__login-success")),s){r=document.createElement("p"),r.classList.add("has-text-align-center"),r.textContent=s;const e=o.querySelector("p");e&&null!=d&&d.sso&&e.replaceWith(r)}const c=200===l;t.classList.add("newspack-registration--"+(c?"success":"error")),c?(o.classList.remove("newspack-registration--hidden"),n.remove(),null!=d&&d.email&&(e.setReaderEmail(d.email),e.setAuthenticated(null==d?void 0:d.authenticated))):r&&(a.appendChild(r),a.classList.remove("newspack-registration--hidden")),i.disabled=!1,t.classList.remove("newspack-registration--in-progress")},n.addEventListener("submit",(t=>{var a;if(t.preventDefault(),n.startLoginFlow(),null===(a=n.npe)||void 0===a||!a.value)return n.endLoginFlow("Please enter a vaild email address.",400);e.getCaptchaToken().then((e=>{if(!e)return;let t=n.captcha_token;t||(t=document.createElement("input"),t.setAttribute("type","hidden"),t.setAttribute("name","captcha_token"),n.appendChild(t)),t.value=e})).catch((e=>{n.endLoginFlow(e,400)})).finally((()=>{const e=new FormData(n);if(!e.has("npe")||!e.get("npe"))return n.endFlow("Please enter a vaild email address.",400);fetch(n.getAttribute("action")||window.location.pathname,{method:"POST",headers:{Accept:"application/json"},body:e}).then((e=>{e.json().then((t=>{let{message:a,data:i}=t;return n.endLoginFlow(a,e.status,i)}))})).catch((e=>{n.endLoginFlow(e,400)}))}))})),e.on("reader",(e=>{let{detail:{authenticated:t}}=e;t&&n.endLoginFlow(null,200)}))}))},"undefined"!=typeof document&&("complete"!==document.readyState&&"interactive"!==document.readyState?document.addEventListener("DOMContentLoaded",t):t());var a=window;for(var i in n)a[i]=n[i];n.__esModule&&Object.defineProperty(a,"__esModule",{value:!0})}();